webpackJsonp([1],{"7NlI":function(t,e){},"8paa":function(t,e){},BCTc:function(t,e){},Et1i:function(t,e){},H9w0:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("4YfN"),r=n.n(s),i=n("9rMa"),a={name:"Tetris",data:function(){return{rows:10,cols:20,rexName:"rex_eye_0"}},computed:r()({},Object(i.b)({maskShow:function(t){return t.maskShow}})),methods:{setActive:function(t){var e=t%10,n=Math.floor(t/10),s=this.$store.state,r=s.moving.render.find(function(t){return t[0]==e&&t[1]==n}),i=s.pile.find(function(t){return t[0]==e&&t[1]==n}),a=s.fullLine.includes(n);return!!(r||i||a)},setDissapear:function(t){var e=t%10,n=Math.floor(t/10);return this.$store.state.dissapear.find(function(t){return t[0]==e&&t[1]==n})}},mounted:function(){var t=this,e=0;setInterval(function(){t.maskShow?(e+=1)<5?t.rexName="rex_eye_"+e%2:e<12?t.rexName="rex_leg_"+e%2:(12==e&&(t.rexName="rex_eye_0"),18===e&&(e=0)):(t.rexName="rex_eye_0",e=0)},150)}},o={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"outer"},[t.maskShow?n("div",{staticClass:"mask"},[n("div",{staticClass:"rex",class:t.rexName}),t._v(" "),n("p",{staticClass:"title"},[t._v("俄罗斯方块")]),t._v(" "),t._m(0),t._v(" "),t._m(1)]):t._e(),t._v(" "),n("div",{staticClass:"square-container"},t._l(t.rows*t.cols,function(e,s){return n("div",{staticClass:"square",class:{active:t.setActive(s),dissapear:t.setDissapear(s)}})}))])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("i",{staticClass:"triangle"}),this._v("\\"),e("i",{staticClass:"triangle down"}),this._v(" | 调整等级")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("i",{staticClass:"triangle left"}),this._v("\\"),e("i",{staticClass:"triangle right"}),this._v(" | 调整行数")])}]};var c=n("vSla")(a,o,!1,function(t){n("Et1i")},"data-v-ad0af078",null).exports,l={name:"Score",data:function(){return{colonActive:!0,hour:u((new Date).getHours()),minute:u((new Date).getMinutes()),stopActive:this.$store.state.isStop&&this.$store.state.hasStart}},computed:r()({},Object(i.b)({level:function(t){return v(t.level)},startLine:function(t){return v(t.startLine)},score:function(t){return v(t.score)},maxScore:function(t){return v(t.maxScore)},hasStart:function(t){return t.hasStart}})),mounted:function(){var t=this;setInterval(function(){t.colonActive=!t.colonActive},1e3),setInterval(function(){t.hour=u((new Date).getHours()),t.minute=u((new Date).getMinutes())},6e3),setInterval(function(){t.$store.state.isStop&&t.$store.state.hasStart?t.stopActive=!t.stopActive:t.stopActive=!1},600)}};function v(t){for(var e=String(t).split(""),n=8-e.length,s=0;s<n;s++)e.splice(0,0,"");return e}function u(t){var e=String(t).split("");return 1===e.length&&e.splice(0,0,"0"),e}var m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"score-container"},[t.hasStart?t._e():n("div",{staticClass:"max-score"},[n("p",{staticClass:"title"},[t._v("最高得分")]),t._v(" "),n("div",{staticClass:"score"},t._l(t.maxScore,function(t){return n("span",{staticClass:"score-item",class:"_"+t})}))]),t._v(" "),t.hasStart?n("div",{staticClass:"score-now"},[n("p",{staticClass:"title"},[t._v("得分")]),t._v(" "),n("div",{staticClass:"score"},t._l(t.score,function(t){return n("span",{staticClass:"score-item",class:"_"+t})}))]):t._e(),t._v(" "),n("p",{staticClass:"title"},[t._v("起始行数")]),t._v(" "),n("div",{staticClass:"score"},t._l(t.startLine,function(t){return n("span",{staticClass:"score-item",class:"_"+t})})),t._v(" "),n("p",{staticClass:"title"},[t._v("级别")]),t._v(" "),n("div",{staticClass:"score"},t._l(t.level,function(t){return n("span",{staticClass:"score-item",class:"_"+t})})),t._v(" "),n("div",{staticClass:"bottom-container"},[n("div",{staticClass:"score"},[n("span",{staticClass:"stop",class:{active:t.stopActive}})]),t._v(" "),n("div",{staticClass:"score"},[t._l(t.hour,function(t){return n("span",{staticClass:"score-item",class:"_"+t})}),t._v(" "),n("span",{staticClass:"score-item colon",class:{active:t.colonActive}}),t._v(" "),t._l(t.minute,function(t){return n("span",{staticClass:"score-item",class:"_"+t})})],2)])])},staticRenderFns:[]};var f={name:"Panel",data:function(){return{}},components:{Tetris:c,Score:n("vSla")(l,m,!1,function(t){n("8paa")},"data-v-2d9cfce6",null).exports}},p={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"panel-outer"},[e("div",{staticClass:"panel"},[e("Tetris"),this._v(" "),e("Score")],1)])},staticRenderFns:[]};var h=n("vSla")(f,p,!1,function(t){n("7NlI")},"data-v-c03bdb34",null).exports,d={name:"BtnGroup",data:function(){return{}},mounted:function(){var t=this;window.addEventListener("keyup",function(e){switch(e.keyCode){case 38:case 87:t.up();break;case 40:case 83:t.down();break;case 37:case 65:t.left();break;case 39:case 68:t.right();break;case 32:t.dropDown()}})},computed:r()({},Object(i.b)({level:function(t){return t.level},startLine:function(t){return t.startLine}})),methods:{left:function(){this.checkHasStart()?this.$store.commit("setLine","minus"):this.$store.commit("left")},right:function(){this.checkHasStart()?this.$store.commit("setLine","add"):this.$store.commit("right")},up:function(){this.checkHasStart()?this.$store.commit("setLevel","add"):this.$store.commit("rotate")},down:function(){this.checkHasStart()?this.$store.commit("setLevel","minus"):this.$store.commit("down")},start:function(){0===this.$store.state.moving.render.length?this.$store.commit("start"):this.$store.commit("restart")},stop:function(){this.checkHasStart()||(this.$store.state.isStop?this.$store.commit("goon"):this.$store.commit("stop"))},dropDown:function(){this.checkHasStart()?this.$store.commit("start"):this.$store.state.isStop?this.$store.commit("goon"):this.$store.commit("dropDown")},checkHasStart:function(){return 0===this.$store.state.moving.render.length&&!1===this.$store.state.hasStart}}},g={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"btn-container"},[n("div",{staticClass:"small-btn-group"},[n("div",{staticClass:"group"},[n("div",{staticClass:"btn small-btn",on:{click:t.start}}),t._v(" "),n("span",{staticClass:"btn-tip bottom small-font"},[t._v("重新开始")])]),t._v(" "),n("div",{staticClass:"group"},[n("div",{staticClass:"btn small-btn",on:{click:t.stop}}),t._v(" "),n("span",{staticClass:"btn-tip bottom small-font"},[t._v("暂停")])])]),t._v(" "),n("div",{staticClass:"btn big-btn",on:{click:t.dropDown}},[n("span",{staticClass:"btn-tip bottom"},[t._v("掉落(SPACE)")])]),t._v(" "),n("div",{staticClass:"btn-group"},[n("div",{staticClass:"btn normal-btn",on:{click:t.up}},[n("span",{staticClass:"btn-tip right"},[t._v("旋转")])]),t._v(" "),n("div",{staticClass:"btn-line"},[n("div",{staticClass:"btn normal-btn",on:{click:t.left}},[n("span",{staticClass:"btn-tip bottom"},[t._v("左移")])]),t._v(" "),t._m(0),t._v(" "),n("div",{staticClass:"btn normal-btn",on:{click:t.right}},[n("span",{staticClass:"btn-tip bottom"},[t._v("右移")])])]),t._v(" "),n("div",{staticClass:"btn normal-btn",on:{click:t.down}},[n("span",{staticClass:"btn-tip right2"},[t._v("下移")])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"center triangle-container"},[e("i",{staticClass:"triangle "}),this._v(" "),e("i",{staticClass:"triangle right"}),this._v(" "),e("i",{staticClass:"triangle left"}),this._v(" "),e("i",{staticClass:"triangle down"})])}]};var _={name:"App",data:function(){return{scale:1}},components:{Panel:h,BtnGroup:n("vSla")(d,g,!1,function(t){n("H9w0")},"data-v-1064a2dc",null).exports},mounted:function(){}},S={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{style:{transform:"scale("+this.scale+")"},attrs:{id:"app"}},[e("div",{staticClass:"box"},[e("Panel"),this._v(" "),e("BtnGroup")],1)])},staticRenderFns:[]};var C=n("vSla")(_,S,!1,function(t){n("BCTc")},null,null).exports,b=n("MVMM"),w=n("3cXf"),k=n.n(w),$=n("IHPB"),x=n.n($);b.a.use(i.a);var y=localStorage.getItem("tetrisData")?JSON.parse(localStorage.getItem("tetrisData")):{maxScore:0},E=new i.a.Store({state:{width:10,height:20,speed:1,pile:[],moving:{type:-1,render:[],center:[]},dissapear:[],interval:800,t:null,startLine:0,level:1,isStop:!0,hasStart:!1,maskShow:!0,fullLine:[],score:0,maxScore:y.maxScore},mutations:{createTetirs:function(t){var e=Math.floor(7*Math.random()),n=Math.round(t.width/2);switch(e){case 0:t.moving={type:1,render:[[n,0],[n+1,0],[n,-1],[n+1,-1]],center:[n,0]};break;case 1:t.moving={type:2,render:[[n-1,0],[n,0],[n+1,0],[n+1,-1]],center:[n,0]};break;case 2:t.moving={type:3,render:[[n-1,-1],[n-1,0],[n,0],[n+1,0]],center:[n,0]};break;case 3:t.moving={type:4,render:[[n-1,0],[n,0],[n+1,0],[n+2,0]],center:[n,0]};break;case 4:t.moving={type:5,render:[[n-1,0],[n,0],[n+1,0],[n,-1]],center:[n,0]};break;case 5:t.moving={type:6,render:[[n-1,0],[n,0],[n,-1],[n+1,-1]],center:[n,0]};break;case 6:t.moving={type:7,render:[[n-1,-1],[n,-1],[n,0],[n+1,0]],center:[n,0]}}},drop:function(t){if(!t.isStop){var e=[];if(t.moving.render.forEach(function(t){e.push([t[0],t[1]+1])}),I(e)||L(t,e)){var n;(n=t.pile).push.apply(n,x()(t.moving.render));var s=function(t){var e=[];return t.pile.filter(function(t){return 0===t[0]}).forEach(function(n){var s=t.pile.filter(function(t){return t[1]===n[1]});10===s.length&&e.push.apply(e,x()(s))}),e.length?e:[]}(t);s.length?(clearInterval(t.t),t.interval=800,this.commit("setDissapearAnimate",{fnName:"start",dissapear:s})):(t.interval=800,this.commit("start"))}else t.moving.render=e,t.moving.center=[t.moving.center[0],t.moving.center[1]+1]}},setDissapearAnimate:function(t,e){var n=this,s=e.fnName,r=void 0===s?"":s,i=e.dissapear,a=void 0===i?[]:i,o=0;t.dissapear=a;var c=setInterval(function(){4==o?(clearInterval(c),t.dissapear=[],function(t,e){var n=[];t.pile.forEach(function(t){void 0===e.find(function(e){return e[0]===t[0]&&e[1]===t[1]})&&n.push(t)});e.sort(function(t,e){return e[1]-t[1]})[0],e.filter(function(t){return 0===t[0]}).length;var s=e.filter(function(t){return 0===t[0]});n.forEach(function(t){var e=s.filter(function(e){return t[1]<=e[1]});e.length&&(t[1]+=e.length)}),t.pile=n}(t,a),function(t,e){var n=e.filter(function(t){return 0===t[0]}).length,s=t.score+100*n+50*(n-1);t.score=s,t.score>t.maxScore&&(t.maxScore=s,y.maxScore=s,localStorage.setItem("tetrisData",k()(y)))}(t,a),r&&n.commit(r)):t.dissapear=o%2==0?a:[],o++},200)},left:function(t){if(!t.isStop){var e=[];t.moving.render.forEach(function(t){e.push([t[0]-1,t[1]])}),I(e)||L(t,e)||(t.moving.render=e,t.moving.center=[t.moving.center[0]-1,t.moving.center[1]])}},right:function(t){if(!t.isStop){var e=[];t.moving.render.forEach(function(t){e.push([t[0]+1,t[1]])}),I(e)||L(t,e)||(t.moving.render=e,t.moving.center=[t.moving.center[0]+1,t.moving.center[1]])}},down:function(t){if(!t.isStop){var e=[];t.moving.render.forEach(function(t){e.push([t[0],t[1]+1])}),I(e)||L(t,e)||(t.moving.render=e,t.moving.center=[t.moving.center[0],t.moving.center[1]+1])}},rotate:function(t){if(!t.isStop&&1!==t.moving.type){var e=[],n=t.moving.center[0],s=t.moving.center[1];4===t.moving.type?e=t.moving.render[0][0]===t.moving.render[1][0]?[[n-1,s],[n,s],[n+1,s],[n+2,s]]:[[n,s-1],[n,s],[n,s+1],[n,s+2]]:t.moving.render.forEach(function(t){var r=n+s-t[1],i=-n+s+t[0];e.push([r,i])}),I(e)||L(t,e)||(t.moving.render=e)}},dropDown:function(t){var e=this;clearInterval(t.t),t.interval=20,t.t=setInterval(function(){e.commit("drop")},t.interval/t.level)},setLevel:function(t,e){switch(e){case"add":t.level=t.level+1>5?5:t.level+1;break;case"minus":t.level=t.level-1<1?1:t.level-1}},setLine:function(t,e){switch(e){case"add":t.startLine=t.startLine+1>10?10:t.startLine+1;break;case"minus":t.startLine=t.startLine-1<0?0:t.startLine-1}},goon:function(t){var e=this;t.isStop&&t.moving.render.length&&(t.isStop=!1,this.commit("drop"),t.t=setInterval(function(){e.commit("drop")},t.interval/t.level))},start:function(t){var e=this;clearInterval(t.t),!1===t.hasStart&&(t.pile=function(t){for(var e=[],n=0;n<t;n++){for(var s=4+Math.floor(7*Math.random()),r=[],i=0;i<s;i++){var a=A(r),o=19-n;r.push([a,o])}if(10===r.length){var c=Math.floor(10*Math.random());r.splice(c,1)}e.push.apply(e,r)}return e}(t.startLine)),t.isStop=!1,t.hasStart=!0,t.maskShow=!1,this.commit("createTetirs"),!function(t){var e=!1;return t.moving.render.forEach(function(n){t.pile.find(function(t){return t[0]===n[0]&&t[1]===n[1]})&&(e=!0)}),e}(t)?t.t=setInterval(function(){e.commit("drop")},t.interval/t.level):(clearInterval(t.t),t.moving={type:-1,render:[],center:[]},this.commit("setDissapearAnimate",{fnName:"restart",dissapear:t.pile}))},stop:function(t){t.isStop=!0,clearInterval(t.t)},restart:function(t){clearInterval(t.t),t.isStop=!0,t.hasStart=!1,this.commit("restartAnimate",["reset"])},restartAnimate:function(t,e){var n=this,s=[],r=t.height-1,i=0;s.push(r);var a=setInterval(function(){40==i&&(clearInterval(a),e.length&&e.forEach(function(t){n.commit(t)})),i<19?(r-=1,s.push(r),t.pile=t.moving.render.filter(function(t){return t[1]!=r}),t.moving.render=t.pile.filter(function(t){return t[1]!=r})):s.splice(s.length-1,1),i++,t.fullLine=s},40)},reset:function(t){t.moving={type:-1,render:[],center:[]},t.pile=[],t.interval=800,t.score=0,t.maskShow=!0}}});function I(t){return!!t.find(function(t){return t[0]<0||t[0]>9||t[1]>19||t[1]<0})}function L(t,e){var n=!1;return t.pile.forEach(function(t){e.find(function(e){return e[0]===t[0]&&e[1]===t[1]})&&(n=!0)}),!!n}function A(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=Math.floor(10*Math.random());return void 0===t.find(function(t){return t[0]===e})?e:A(t)}b.a.config.productionTip=!1,new b.a({el:"#app",components:{App:C},store:E,template:"<App/>"})}},["NHnr"]);
//# sourceMappingURL=app.fdb9a1c74e7bcda8be3c.js.map